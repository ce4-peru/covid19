arrows(x0=set$c13mean-set$C13sd, y0=set$C15mean,
x1=set$c13mean+set$C13sd, y1=set$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2tipo.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set$c13mean, set$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
#axes=FALSE,
xlab="C13", ylab="C15", pch=16, cex=1)
#axis(1, -30:0)
#axis(2, 1:10)
# Vertical arrow
arrows(x0=set$c13mean,
y0=set$C15mean-set$C15sd,
x1=set$c13mean,
y1=set$C15mean+set$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set$c13mean-set$C13sd, y0=set$C15mean,
x1=set$c13mean+set$C13sd, y1=set$C15mean, code=0, col="red", lwd=1)
text(set$c13mean, set$C15mean, labels =set$Name)
dev.off()
#### graph 2
# create dataset
set_plot2 <- set[c(2:4,6,7,10),]
levels(set_plot2$Name) <- c(levels(set_plot2$Name), "CF4", "CF5")
set_plot2 <- rbind(set_plot2, c(-16.53, NA, 16.02, NA, "CF4"))
set_plot2 <- rbind(set_plot2, c(-16.55, NA, 14.37, NA, "CF5"))
set_plot2$c13mean <- as.numeric(set_plot2$c13mean)
set_plot2$C13sd <- as.numeric(set_plot2$C13sd)
set_plot2$C15mean <- as.numeric(set_plot2$C15mean)
set_plot2$C15sd <- as.numeric(set_plot2$C15sd)
set_plot2
png("v1plot2.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot2$c13mean, set_plot2$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
#axes=FALSE,
xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_plot2$c13mean,
y0=set_plot2$C15mean-set_plot2$C15sd,
x1=set_plot2$c13mean,
y1=set_plot2$C15mean+set_plot2$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot2$c13mean-set_plot2$C13sd,
y0=set_plot2$C15mean,
x1=set_plot2$c13mean+set_plot2$C13sd,
y1=set_plot2$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot2.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot2$c13mean, set_plot2$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_plot2$c13mean,
y0=set_plot2$C15mean-set_plot2$C15sd,
x1=set_plot2$c13mean,
y1=set_plot2$C15mean+set_plot2$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot2$c13mean-set_plot2$C13sd,
y0=set_plot2$C15mean,
x1=set_plot2$c13mean+set_plot2$C13sd,
y1=set_plot2$C15mean, code=0, col="red", lwd=1)
text(set_plot2$c13mean, set_plot2$C15mean, labels=set_plot2$Name)
dev.off()
#### graph 3
# create dataset
set_plot3 <- set[c(9,5,8,1),]
levels(set_plot3$Name) <- c(levels(set_plot3$Name), "CF4", "CF5")
set_plot3 <- rbind(set_plot3, c(-16.53, NA, 16.02, NA, "CF4"))
set_plot3 <- rbind(set_plot3, c(-16.55, NA, 14.37, NA, "CF5"))
set_plot3$c13mean <- as.numeric(set_plot3$c13mean)
set_plot3$C13sd <- as.numeric(set_plot3$C13sd)
set_plot3$C15mean <- as.numeric(set_plot3$C15mean)
set_plot3$C15sd <- as.numeric(set_plot3$C15sd)
set_plot3
png("v1plot3.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot3$c13mean, set_plot3$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1)
# plot(set_plot3$c13mean, set_plot3$C15mean, ylim=c(4,22), xlim=c(-22,-11),
#      xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_plot3$c13mean,
y0=set_plot3$C15mean-set_plot3$C15sd,
x1=set_plot3$c13mean,
y1=set_plot3$C15mean+set_plot3$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot3$c13mean-set_plot3$C13sd, y0=set_plot3$C15mean,
x1=set_plot3$c13mean+set_plot3$C13sd, y1=set_plot3$C15mean,
code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot3.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot3$c13mean, set_plot3$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_plot3$c13mean,
y0=set_plot3$C15mean-set_plot3$C15sd,
x1=set_plot3$c13mean,
y1=set_plot3$C15mean+set_plot3$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot3$c13mean-set_plot3$C13sd,
y0=set_plot3$C15mean,
x1=set_plot3$c13mean+set_plot3$C13sd,
y1=set_plot3$C15mean, code=0, col="red", lwd=1)
text(set_plot3$c13mean, set_plot3$C15mean,
labels =set_plot3$Name)
dev.off()
#### graph 4
# subset dataset
# 11
table(data$Ncomun_Familia)
levels(data$Ncomun_Familia)
data_plot4 <- subset(data, Ncomun_Familia %in% c("Zapallo", "Palta",
"LÃºcuma", "Guayaba ",
"Pallar", "Pacae",
"ManÃ­", "MaÃ­z",
"M. Fertilizado"))
# isotopo 13C
data_plot4$Ncomun_Familia <- factor(data_plot4$Ncomun_Familia)
table(data_plot4$Ncomun_Familia)
c13mean_p4 <- as.data.frame(tapply(data_plot4$C13,
list(data_plot4$Ncomun_Familia), mean))
C13sd_p4 <- as.data.frame(tapply(data_plot4$C13,
list(data_plot4$Ncomun_Familia), sd))
# 1 de Maiz Fertilizado
### isotopo 15N
data2_plot4 <- subset(data_plot4, !is.na(C15))
C15mean_p4 <- as.data.frame(tapply(data2_plot4$C15,
list(data2_plot4$Ncomun_Familia), mean))
C15sd_p4 <- as.data.frame(tapply(data2_plot4$C15,
list(data2_plot4$Ncomun_Familia), sd))
# 1  Maiz Fertilizado
namesdata <- as.data.frame(levels(data_plot4$Ncomun_Familia))
set_p4 <- cbind(c13mean_p4, C13sd_p4, C15mean_p4, C15sd_p4, namesdata)
colnames(set_p4)[1] <- "c13mean"
colnames(set_p4)[2] <- "C13sd"
colnames(set_p4)[3] <- "C15mean"
colnames(set_p4)[4] <- "C15sd"
colnames(set_p4)[5] <- "Name"
# add deads
levels(set_p4$Name) <- c(levels(set_p4$Name), "CF4", "CF5")
set_p4 <- rbind(set_p4, c(-16.53, NA, 16.02, NA, "CF4"))
set_p4 <- rbind(set_p4, c(-16.55, NA, 14.37, NA, "CF5"))
set_p4$c13mean <- as.numeric(set_p4$c13mean)
set_p4$C13sd <- as.numeric(set_p4$C13sd)
set_p4$C15mean <- as.numeric(set_p4$C15mean)
set_p4$C15sd <- as.numeric(set_p4$C15sd)
set_p4
png("v1plot4.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
# plot(set_p4$c13mean, set_p4$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
#      xlab="C13", ylab="C15", pch=16, cex=1)
plot(set_p4$c13mean, set_p4$C15mean, ylim=c(-3,24), xlim=c(-32,-8),
xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_p4$c13mean,
y0=set_p4$C15mean-set_p4$C15sd,
x1=set_p4$c13mean,
y1=set_p4$C15mean+set_p4$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p4$c13mean-set_p4$C13sd,
y0=set_p4$C15mean,
x1=set_p4$c13mean+set_p4$C13sd,
y1=set_p4$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot4.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_p4$c13mean, set_p4$C15mean, ylim=c(-3,24), xlim=c(-32,-8),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_p4$c13mean,
y0=set_p4$C15mean-set_p4$C15sd,
x1=set_p4$c13mean,
y1=set_p4$C15mean+set_p4$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p4$c13mean-set_p4$C13sd,
y0=set_p4$C15mean,
x1=set_p4$c13mean+set_p4$C13sd,
y1=set_p4$C15mean, code=0, col="red", lwd=1)
text(set_p4$c13mean, set_p4$C15mean, labels=set_p4$Name)
dev.off()
### plot 5
# subset dataset
# 12
levels(data$Ncomun_Familia)
data_plot5 <- subset(data, Ncomun_Familia %in% c("Tramboyo", "Chita ",
"Coco", "Choro ",
"Chanque", "Macha",
"Pelicano pardo",
"Piquero peruano",
"Cuy", "Camelido"))
# isotopo 13C
data_plot5$Ncomun_Familia <- factor(data_plot5$Ncomun_Familia)
table(data_plot5$Ncomun_Familia)
c13mean_p5 <- as.data.frame(tapply(data_plot5$C13,
list(data_plot5$Ncomun_Familia), mean))
C13sd_p5 <- as.data.frame(tapply(data_plot5$C13,
list(data_plot5$Ncomun_Familia), sd))
### isotopo 15N
data2_plot5 <- subset(data_plot5, !is.na(C15))
C15mean_p5 <- as.data.frame(tapply(data2_plot5$C15,
list(data2_plot5$Ncomun_Familia), mean))
C15sd_p5 <- as.data.frame(tapply(data2_plot5$C15,
list(data2_plot5$Ncomun_Familia), sd))
namesdata <- as.data.frame(levels(data_plot5$Ncomun_Familia))
set_p5 <- cbind(c13mean_p5, C13sd_p5, C15mean_p5, C15sd_p5, namesdata)
colnames(set_p5)[1] <- "c13mean"
colnames(set_p5)[2] <- "C13sd"
colnames(set_p5)[3] <- "C15mean"
colnames(set_p5)[4] <- "C15sd"
colnames(set_p5)[5] <- "Name"
# add deads
levels(set_p5$Name) <- c(levels(set_p5$Name), "CF4", "CF5")
set_p5 <- rbind(set_p5, c(-16.53, NA, 16.02, NA, "CF4"))
set_p5 <- rbind(set_p5, c(-16.55, NA, 14.37, NA, "CF5"))
set_p5$c13mean <- as.numeric(set_p5$c13mean)
set_p5$C13sd <- as.numeric(set_p5$C13sd)
set_p5$C15mean <- as.numeric(set_p5$C15mean)
set_p5$C15sd <- as.numeric(set_p5$C15sd)
set_p5
png("v1plot5.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_p5$c13mean, set_p5$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1)
# plot(set_p5$c13mean, set_p5$C15mean, ylim=c(5,23), xlim=c(-24,-9),
#      xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_p5$c13mean,
y0=set_p5$C15mean-set_p5$C15sd,
x1=set_p5$c13mean,
y1=set_p5$C15mean+set_p5$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p5$c13mean-set_p5$C13sd,
y0=set_p5$C15mean,
x1=set_p5$c13mean+set_p5$C13sd,
y1=set_p5$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot5.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_p5$c13mean, set_p5$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_p5$c13mean,
y0=set_p5$C15mean-set_p5$C15sd,
x1=set_p5$c13mean,
y1=set_p5$C15mean+set_p5$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p5$c13mean-set_p5$C13sd,
y0=set_p5$C15mean,
x1=set_p5$c13mean+set_p5$C13sd,
y1=set_p5$C15mean, code=0, col="red", lwd=1)
text(set_p5$c13mean, set_p5$C15mean, labels=set_p5$Name)
dev.off()
library(data.table)
library(dplyr)
library(tidyr)
library(tidyverse)
library(lubridate)
## set directory
setwd("~/covid19")
## Call data
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200412_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200413_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200414_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200415_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200416_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200417_AL.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200418_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200419_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200420_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200421_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200422_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200423_CA.csv")
###### limpieza casos por indartamento #####
library(data.table)
library(dplyr)
library(tidyr)
library(tidyverse)
library(lubridate)
## set directory
setwd("~/covid19")
## Call data
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200412_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200413_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200414_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200415_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200416_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200417_AL.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200418_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200419_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200420_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200421_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200422_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200423_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200424_AL.csv")
covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200425_MD.csv")
## Checar base
str(covid_dep) # 50 obs. of  31 variables
names(covid_dep)
# Eliminar columnas y filas
#Recuerde aqui quitar la ultima columna y las columna y fila de "totales"
# Hasta la corrida de hoy 19 de abril era quitar la fila 46.
# Ma?ana 23 hay que sacar la fila 49.
# Dia 24/04 se saco la fila 50.
covid_dep <- covid_dep[-50,-c(1,28:31)] #OJO
###### limpieza casos por indartamento #####
library(data.table)
library(dplyr)
library(tidyr)
library(tidyverse)
library(lubridate)
## set directory
setwd("~/covid19")
## Call data
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200412_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200413_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200414_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200415_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200416_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200417_AL.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200418_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200419_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200420_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200421_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200422_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200423_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200424_AL.csv")
covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200425_MD.csv")
## Checar base
str(covid_dep) # 50 obs. of  31 variables
names(covid_dep)
# [1] "DÃƒ­a"         "Fecha"       "LIM"         "ARE"         "HUC"         "ICA"
# [7] "CUS"         "PIU"         "LAM"         "CAL"         "LAL"         "ANC"
# [13] "LOR"         "SAM"         "MDD"         "JUN"         "TUM"         "CAJ"
# [19] "PAS"         "TAC"         "AYA"         "HUA"         "APU"         "MOQ"
# [25] "PUN"         "AMA"         "UCA"         "Total"       "Acumulado"   "Descartados"
# [31] "Fuente"
# >
# Eliminar columnas y filas
covid_dep <- covid_dep[-51,-c(1,28:31)
head(covid_dep)
# Transform to character
# No me sale
covid_dep <- mutate_if(covid_dep, is.character, toupper)
###### limpieza casos por indartamento #####
library(data.table)
library(dplyr)
library(tidyr)
library(tidyverse)
library(lubridate)
## set directory
setwd("~/covid19")
## Call data
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200412_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200413_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200414_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200415_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200416_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200417_AL.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200418_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200419_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200420_MD.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200421_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200422_GF.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200423_CA.csv")
# covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200424_AL.csv")
covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200425_MD.csv")
## Checar base
str(covid_dep) # 50 obs. of  31 variables
names(covid_dep)
# [1] "DÃƒ­a"         "Fecha"       "LIM"         "ARE"         "HUC"         "ICA"
# [7] "CUS"         "PIU"         "LAM"         "CAL"         "LAL"         "ANC"
# [13] "LOR"         "SAM"         "MDD"         "JUN"         "TUM"         "CAJ"
# [19] "PAS"         "TAC"         "AYA"         "HUA"         "APU"         "MOQ"
# [25] "PUN"         "AMA"         "UCA"         "Total"       "Acumulado"   "Descartados"
# [31] "Fuente"
# >
# Eliminar columnas y filas
#Recuerde aqui quitar la ultima columna y las columna y fila de "totales"
# Ma?ana 26 hay que sacar la fila 52.
# Dia 25/04 se sac[o] la fila 51.
covid_dep <- covid_dep[-51,-c(1,28:31)]
head(covid_dep)
# Transform to character
# No me sale
covid_dep <- mutate_if(covid_dep, is.character, toupper)
sapply(covid_dep, class)
### variableby variable
table(covid_dep$Fecha)
# ##### fecha to as.date format ####
covid_dep<-covid_dep %>%
mutate(Fecha1 = as.Date(as.character(Fecha), format = "%d/%m/%y"))
### ordenar base ###
names(covid_dep)
covid_dep<- covid_dep%>%
select(-Fecha)
# Tidy data to work with it
covid_dep2 <- gather(covid_dep,
key = "REGION",
value = "CASOS",
-Fecha1)
covid_dep2
covid_dep2$CASOS[is.na(covid_dep2$CASOS)] <- 0
#write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200414_CA_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200415_GF_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200417_AL_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200418_MD_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200419_GF_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200420_MD_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200421_CA_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200422_GF_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200423_CA_clean.csv", row.names = FALSE)
# write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200424_AL_clean.csv", row.names = FALSE)
write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200425_MD_clean.csv", row.names = FALSE)
###### limpieza casos por indartamento #####
library(data.table)
library(dplyr)
library(tidyr)
library(tidyverse)
library(lubridate)
## set directory
setwd("~/covid19")
## Call data
#covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200403_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200404_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200405_CA.csv")
#covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200406_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200407_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200408_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200409_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200410_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200411_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200412_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200413_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200414_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200415_GF.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200416_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200417_AL.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200418_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200419_GF.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200420_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200421_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200422_GF.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200423_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200424_AL.csv")
covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200425_AL.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200415_GF.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200416_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200417_AL.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200418_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200419_GF.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200420_MD.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200421_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200422_GF.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200423_CA.csv")
# covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200424_AL.csv")
covid_dia <- fread("~/covid19/data/crudas/covidPE_pordia_20200425_MD.csv")
## Checar base
str(covid_dia) # 49 obs. of  14 variables
names(covid_dia)
head(covid_dia)
# Transform to character
covid_dia <- mutate_if(covid_dia, is.character, toupper)
sapply(covid_dia, class)
### variable by variable
### Fecha ####
table(covid_dia$FECHA)
#### separando caracteres en varias columnas ######
covid_dia$FECHA2 <- covid_dia$FECHA
covid_dia <- separate(covid_dia,
col = "FECHA2",
into = c("DIA", "MES","ANO"),
sep = "/")
##### fecha to as.date format ####
covid_dia<-covid_dia %>%
mutate(FECHA = as.Date(as.character(FECHA), format = "%d/%m/%y"))
### ordenar base ###
names(covid_dia)
covid_dia <- covid_dia[,c(1, 15:17, 2:14)]
## Fecha
str(covid_dia$FECHA) # date
unique(covid_dia$FECHA)
unique(covid_dia$TOTAL_POSITIVOS)
sum(is.na(covid_dia$TOTAL_POSITIVOS)) # 0 NAs
sum(is.na(covid_dia$FECHA)) # 0 NAs
unique(covid_dia$TOTAL_PRUEBAS)
sum(is.na(covid_dia$TOTAL_PRUEBAS)) # 0 NAs
unique(covid_dia$TOTAL_DESCARTADOS)
sum(is.na(covid_dia$TOTAL_DESCARTADOS)) # 0 NAs
unique(covid_dia$POSITIVOS_DIA)
sum(is.na(covid_dia$POSITIVOS_DIA)) # 0 NAs
unique(covid_dia$PRUEBAS_DIA)
sum(is.na(covid_dia$PRUEBAS_DIA)) # 0 NAs
unique(covid_dia$DESCARTADOS_DIA)
sum(is.na(covid_dia$DESCARTADOS_DIA)) # 0
unique(covid_dia$RECUPERADOS)
sum(is.na(covid_dia$RECUPERADOS)) # 9 NAs
unique(covid_dia$FALLECIDOS)
sum(is.na(covid_dia$FALLECIDOS)) # 12 NAs
unique(covid_dia$HOSPITALIZADOS)
sum(is.na(covid_dia$HOSPITALIZADOS)) # 12 NAs
unique(covid_dia$HOSPITALIZADOS_UCI)
sum(is.na(covid_dia$HOSPITALIZADOS_UCI)) # 19 NAs
names(covid_dia)
# Save csv.
# CAMBIA EL NOMBRE! NO TE OLVIDES!
write.csv(covid_dia, "data/modificadas/covidPE_PORdia_20200425_MD_clean.csv")
