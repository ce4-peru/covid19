<<<<<<< HEAD
# CAM       Invetebrado Marino                Legumbre
# 5.206406                 2.772109                 5.030770
# Maiz Fertilizado        Mamífero terrestre Peces/ mamíferos marinos
# NA                 1.543851                 2.955196
# Planta marina
# 3.803104
# 1  Maiz Fertilizado
namesdata <- as.data.frame(levels(data$Tipo))
set <- cbind(c13mean, C13sd, C15mean, C15sd, namesdata)
colnames(set)[1] <- "c13mean"
colnames(set)[2] <- "C13sd"
colnames(set)[3] <- "C15mean"
colnames(set)[4] <- "C15sd"
colnames(set)[5] <- "Name"
set
# Tipo
png("v1tipo.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set$c13mean, set$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
#axes=FALSE,
xlab="C13", ylab="C15", pch=16, cex=1)
#axis(1, -30:0)
#axis(2, 1:10)
# Vertical arrow
arrows(x0=set$c13mean,
y0=set$C15mean-set$C15sd,
x1=set$c13mean,
y1=set$C15mean+set$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set$c13mean-set$C13sd, y0=set$C15mean,
x1=set$c13mean+set$C13sd, y1=set$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2tipo.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set$c13mean, set$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
#axes=FALSE,
xlab="C13", ylab="C15", pch=16, cex=1)
#axis(1, -30:0)
#axis(2, 1:10)
# Vertical arrow
arrows(x0=set$c13mean,
y0=set$C15mean-set$C15sd,
x1=set$c13mean,
y1=set$C15mean+set$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set$c13mean-set$C13sd, y0=set$C15mean,
x1=set$c13mean+set$C13sd, y1=set$C15mean, code=0, col="red", lwd=1)
text(set$c13mean, set$C15mean, labels =set$Name)
dev.off()
#### graph 2
# create dataset
set_plot2 <- set[c(2:4,6,7,10),]
levels(set_plot2$Name) <- c(levels(set_plot2$Name), "CF4", "CF5")
set_plot2 <- rbind(set_plot2, c(-16.53, NA, 16.02, NA, "CF4"))
set_plot2 <- rbind(set_plot2, c(-16.55, NA, 14.37, NA, "CF5"))
set_plot2$c13mean <- as.numeric(set_plot2$c13mean)
set_plot2$C13sd <- as.numeric(set_plot2$C13sd)
set_plot2$C15mean <- as.numeric(set_plot2$C15mean)
set_plot2$C15sd <- as.numeric(set_plot2$C15sd)
set_plot2
png("v1plot2.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot2$c13mean, set_plot2$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
#axes=FALSE,
xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_plot2$c13mean,
y0=set_plot2$C15mean-set_plot2$C15sd,
x1=set_plot2$c13mean,
y1=set_plot2$C15mean+set_plot2$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot2$c13mean-set_plot2$C13sd,
y0=set_plot2$C15mean,
x1=set_plot2$c13mean+set_plot2$C13sd,
y1=set_plot2$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot2.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot2$c13mean, set_plot2$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_plot2$c13mean,
y0=set_plot2$C15mean-set_plot2$C15sd,
x1=set_plot2$c13mean,
y1=set_plot2$C15mean+set_plot2$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot2$c13mean-set_plot2$C13sd,
y0=set_plot2$C15mean,
x1=set_plot2$c13mean+set_plot2$C13sd,
y1=set_plot2$C15mean, code=0, col="red", lwd=1)
text(set_plot2$c13mean, set_plot2$C15mean, labels=set_plot2$Name)
dev.off()
#### graph 3
# create dataset
set_plot3 <- set[c(9,5,8,1),]
levels(set_plot3$Name) <- c(levels(set_plot3$Name), "CF4", "CF5")
set_plot3 <- rbind(set_plot3, c(-16.53, NA, 16.02, NA, "CF4"))
set_plot3 <- rbind(set_plot3, c(-16.55, NA, 14.37, NA, "CF5"))
set_plot3$c13mean <- as.numeric(set_plot3$c13mean)
set_plot3$C13sd <- as.numeric(set_plot3$C13sd)
set_plot3$C15mean <- as.numeric(set_plot3$C15mean)
set_plot3$C15sd <- as.numeric(set_plot3$C15sd)
set_plot3
png("v1plot3.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot3$c13mean, set_plot3$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1)
# plot(set_plot3$c13mean, set_plot3$C15mean, ylim=c(4,22), xlim=c(-22,-11),
#      xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_plot3$c13mean,
y0=set_plot3$C15mean-set_plot3$C15sd,
x1=set_plot3$c13mean,
y1=set_plot3$C15mean+set_plot3$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot3$c13mean-set_plot3$C13sd, y0=set_plot3$C15mean,
x1=set_plot3$c13mean+set_plot3$C13sd, y1=set_plot3$C15mean,
code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot3.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_plot3$c13mean, set_plot3$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_plot3$c13mean,
y0=set_plot3$C15mean-set_plot3$C15sd,
x1=set_plot3$c13mean,
y1=set_plot3$C15mean+set_plot3$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_plot3$c13mean-set_plot3$C13sd,
y0=set_plot3$C15mean,
x1=set_plot3$c13mean+set_plot3$C13sd,
y1=set_plot3$C15mean, code=0, col="red", lwd=1)
text(set_plot3$c13mean, set_plot3$C15mean,
labels =set_plot3$Name)
dev.off()
#### graph 4
# subset dataset
# 11
table(data$Ncomun_Familia)
levels(data$Ncomun_Familia)
data_plot4 <- subset(data, Ncomun_Familia %in% c("Zapallo", "Palta",
"Lúcuma", "Guayaba ",
"Pallar", "Pacae",
"Maní", "Maíz",
"M. Fertilizado"))
# isotopo 13C
data_plot4$Ncomun_Familia <- factor(data_plot4$Ncomun_Familia)
table(data_plot4$Ncomun_Familia)
c13mean_p4 <- as.data.frame(tapply(data_plot4$C13,
list(data_plot4$Ncomun_Familia), mean))
C13sd_p4 <- as.data.frame(tapply(data_plot4$C13,
list(data_plot4$Ncomun_Familia), sd))
# 1 de Maiz Fertilizado
### isotopo 15N
data2_plot4 <- subset(data_plot4, !is.na(C15))
C15mean_p4 <- as.data.frame(tapply(data2_plot4$C15,
list(data2_plot4$Ncomun_Familia), mean))
C15sd_p4 <- as.data.frame(tapply(data2_plot4$C15,
list(data2_plot4$Ncomun_Familia), sd))
# 1  Maiz Fertilizado
namesdata <- as.data.frame(levels(data_plot4$Ncomun_Familia))
set_p4 <- cbind(c13mean_p4, C13sd_p4, C15mean_p4, C15sd_p4, namesdata)
colnames(set_p4)[1] <- "c13mean"
colnames(set_p4)[2] <- "C13sd"
colnames(set_p4)[3] <- "C15mean"
colnames(set_p4)[4] <- "C15sd"
colnames(set_p4)[5] <- "Name"
# add deads
levels(set_p4$Name) <- c(levels(set_p4$Name), "CF4", "CF5")
set_p4 <- rbind(set_p4, c(-16.53, NA, 16.02, NA, "CF4"))
set_p4 <- rbind(set_p4, c(-16.55, NA, 14.37, NA, "CF5"))
set_p4$c13mean <- as.numeric(set_p4$c13mean)
set_p4$C13sd <- as.numeric(set_p4$C13sd)
set_p4$C15mean <- as.numeric(set_p4$C15mean)
set_p4$C15sd <- as.numeric(set_p4$C15sd)
set_p4
png("v1plot4.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
# plot(set_p4$c13mean, set_p4$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
#      xlab="C13", ylab="C15", pch=16, cex=1)
plot(set_p4$c13mean, set_p4$C15mean, ylim=c(-3,24), xlim=c(-32,-8),
xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_p4$c13mean,
y0=set_p4$C15mean-set_p4$C15sd,
x1=set_p4$c13mean,
y1=set_p4$C15mean+set_p4$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p4$c13mean-set_p4$C13sd,
y0=set_p4$C15mean,
x1=set_p4$c13mean+set_p4$C13sd,
y1=set_p4$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot4.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_p4$c13mean, set_p4$C15mean, ylim=c(-3,24), xlim=c(-32,-8),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_p4$c13mean,
y0=set_p4$C15mean-set_p4$C15sd,
x1=set_p4$c13mean,
y1=set_p4$C15mean+set_p4$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p4$c13mean-set_p4$C13sd,
y0=set_p4$C15mean,
x1=set_p4$c13mean+set_p4$C13sd,
y1=set_p4$C15mean, code=0, col="red", lwd=1)
text(set_p4$c13mean, set_p4$C15mean, labels=set_p4$Name)
dev.off()
### plot 5
# subset dataset
# 12
levels(data$Ncomun_Familia)
data_plot5 <- subset(data, Ncomun_Familia %in% c("Tramboyo", "Chita ",
"Coco", "Choro ",
"Chanque", "Macha",
"Pelicano pardo",
"Piquero peruano",
"Cuy", "Camelido"))
# isotopo 13C
data_plot5$Ncomun_Familia <- factor(data_plot5$Ncomun_Familia)
table(data_plot5$Ncomun_Familia)
c13mean_p5 <- as.data.frame(tapply(data_plot5$C13,
list(data_plot5$Ncomun_Familia), mean))
C13sd_p5 <- as.data.frame(tapply(data_plot5$C13,
list(data_plot5$Ncomun_Familia), sd))
### isotopo 15N
data2_plot5 <- subset(data_plot5, !is.na(C15))
C15mean_p5 <- as.data.frame(tapply(data2_plot5$C15,
list(data2_plot5$Ncomun_Familia), mean))
C15sd_p5 <- as.data.frame(tapply(data2_plot5$C15,
list(data2_plot5$Ncomun_Familia), sd))
namesdata <- as.data.frame(levels(data_plot5$Ncomun_Familia))
set_p5 <- cbind(c13mean_p5, C13sd_p5, C15mean_p5, C15sd_p5, namesdata)
colnames(set_p5)[1] <- "c13mean"
colnames(set_p5)[2] <- "C13sd"
colnames(set_p5)[3] <- "C15mean"
colnames(set_p5)[4] <- "C15sd"
colnames(set_p5)[5] <- "Name"
# add deads
levels(set_p5$Name) <- c(levels(set_p5$Name), "CF4", "CF5")
set_p5 <- rbind(set_p5, c(-16.53, NA, 16.02, NA, "CF4"))
set_p5 <- rbind(set_p5, c(-16.55, NA, 14.37, NA, "CF5"))
set_p5$c13mean <- as.numeric(set_p5$c13mean)
set_p5$C13sd <- as.numeric(set_p5$C13sd)
set_p5$C15mean <- as.numeric(set_p5$C15mean)
set_p5$C15sd <- as.numeric(set_p5$C15sd)
set_p5
png("v1plot5.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_p5$c13mean, set_p5$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1)
# plot(set_p5$c13mean, set_p5$C15mean, ylim=c(5,23), xlim=c(-24,-9),
#      xlab="C13", ylab="C15", pch=16, cex=1)
# Vertical arrow
arrows(x0=set_p5$c13mean,
y0=set_p5$C15mean-set_p5$C15sd,
x1=set_p5$c13mean,
y1=set_p5$C15mean+set_p5$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p5$c13mean-set_p5$C13sd,
y0=set_p5$C15mean,
x1=set_p5$c13mean+set_p5$C13sd,
y1=set_p5$C15mean, code=0, col="red", lwd=1)
dev.off()
# with labels
png("v2plot5.png", width=9, height=7, units="in", res=600)
par(mar=c(4,4,1,1))
plot(set_p5$c13mean, set_p5$C15mean, ylim=c(-1,26), xlim=c(-27,-3),
xlab="C13", ylab="C15", pch=16, cex=1, col="grey")
# Vertical arrow
arrows(x0=set_p5$c13mean,
y0=set_p5$C15mean-set_p5$C15sd,
x1=set_p5$c13mean,
y1=set_p5$C15mean+set_p5$C15sd, code=0, col="blue", lwd=1)
# Horizontal arrow
arrows(x0=set_p5$c13mean-set_p5$C13sd,
y0=set_p5$C15mean,
x1=set_p5$c13mean+set_p5$C13sd,
y1=set_p5$C15mean, code=0, col="red", lwd=1)
text(set_p5$c13mean, set_p5$C15mean, labels=set_p5$Name)
dev.off()
###### incidencia de Peru casos COVID19#####
=======
names(covid_dia)
# [1] "FECHA"              "DIA"                "MES"                "ANO"
# [5] "TOTAL_POSITIVOS"    "TOTAL_PRUEBAS"      "TOTAL_DESCARTADOS"  "POSITIVOS_DIA"
# [9] "PRUEBAS_DIA"        "DESCARTADOS_DIA"    "RECUPERADOS"        "FALLECIDOS"
# [13] "HOSPITALIZADOS"     "HOSPITALIZADOS_UCI" "OBSERVACION"        "FUENTE"
# [17] "ACTUALIZACION"
# Save csv.
write.csv(covid_dia, "data/modificadas/covidPE_PORdia_20200416_CA_clean.csv")
library(data.table)
library(dplyr)
library(tidyr)
library(tidyverse)
library(lubridate)
## set directory
setwd("~/covid19")
covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200416_CA.csv")
str(covid_dep) # 41 obs. of  31 variables
names(covid_dep)
covid_dep <- covid_dep[-41,-c(1,28:31)] #OJO
# Mas adelante  Sacar los "S1N0 del nombre de la variable
head(covid_dep)
covid_dep <- mutate_if(covid_dep, is.character, toupper)
sapply(covid_dep, class)
table(covid_dep$Fecha)
covid_dep <- fread("~/covid19/data/crudas/covidPE_DEP_20200416_CA.csv")
## Checar base
str(covid_dep) # 42 obs. of  31 variables
names(covid_dep)
covid_dep <- covid_dep[-42,-c(1,28:31)] #OJO
# Mas adelante  Sacar los "S1N0 del nombre de la variable
head(covid_dep)
covid_dep <- mutate_if(covid_dep, is.character, toupper)
sapply(covid_dep, class)
table(covid_dep$Fecha)
covid_dep<-covid_dep %>%
mutate(Fecha1 = as.Date(as.character(Fecha), format = "%d/%m/%y"))
### ordenar base ###
names(covid_dep)
covid_dep<- covid_dep%>%
select(-Fecha)
# Tidy data to work with it
covid_dep2 <- gather(covid_dep,
key = "REGION",
value = "CASOS",
-Fecha1)
covid_dep2
covid_dep2$CASOS[is.na(covid_dep2$CASOS)] <- 0
write.csv(covid_dep2, "data/modificadas/covidPE_DEP_20200416_CA_clean.csv", row.names = FALSE)
acumulado<-fread("~/covid19/data/modificadas/covidPE_PORdia_20200416_CA_clean.csv")
acumulado1<-melt(acumulado,id="FECHA")
acumulado1$value<-as.numeric(acumulado1$value)
target <- c("TOTAL_POSITIVOS", "TOTAL_PRUEBAS")
acumulado1<-filter(acumulado1, variable %in% target)
acumulado1<-acumulado1 %>%
mutate(Fecha = as.Date(FECHA))
setwd("~/covid19/outputs_covid19/")
png(filename="20200416_pruebas_vs_positivos_COVID19.png", width=1100, height=600)
p<-ggplot() +
geom_line(data = acumulado1, aes(Fecha, value, colour=variable,group=variable),alpha =1.6) +
scale_colour_manual(values=c("red", "blue"))+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
# scale_x_date() +
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
# theme_minimal()+
theme(panel.background = element_rect(fill = "white"),
legend.position = c(0.35,0.95),
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
labs(title="SARS-CoV-2 en Perú", y="Pruebas positivas y pruebas realizadas",
x="Fecha", caption="Source :varios")+
theme(plot.title = element_text(face = "bold.italic",size = 5) )+
bbc_style()
print(p)
library(data.table)
library(dplyr)
library(tidyr)
# library(tidyverse)
library(lubridate)
library(ggplot2)
library(directlabels)
library(reshape)
library(colorspace)
library(plotly)
library(JLutils)
#### si no tienes el paquete bbplot
# devtools::install_github('bbc/bbplot')
library(bbplot)
library(scales)
library("gridExtra")
library(cowplot)
######### curvas nacionales de positivos y pruebas totales ##################
### leer esta data de los puntos de corte para ambos dibujos ####
d=data.frame(Fecha=as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")), event=c(" Primer Caso", " Cierre colegios", "Cierre universidades", " Inicio de cuarentena", " Extensión cuarentena", " Restricción por sexo","Toque de queda 18pm-5am","Extensión cuarentena"))
acumulado<-fread("~/covid19/data/modificadas/covidPE_PORdia_20200416_CA_clean.csv")
acumulado1<-melt(acumulado,id="FECHA")
acumulado1$value<-as.numeric(acumulado1$value)
target <- c("TOTAL_POSITIVOS", "TOTAL_PRUEBAS")
acumulado1<-filter(acumulado1, variable %in% target)
acumulado1<-acumulado1 %>%
mutate(Fecha = as.Date(FECHA))
setwd("~/covid19/outputs_covid19/")
#
png(filename="20200416_pruebas_vs_positivos_COVID19.png", width=1100, height=600)
p<-ggplot() +
geom_line(data = acumulado1, aes(Fecha, value, colour=variable,group=variable),alpha =1.6) +
scale_colour_manual(values=c("red", "blue"))+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
# scale_x_date() +
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
# theme_minimal()+
theme(panel.background = element_rect(fill = "white"),
legend.position = c(0.35,0.95),
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
labs(title="SARS-CoV-2 en Perú", y="Pruebas positivas y pruebas realizadas",
x="Fecha", caption="Source :varios")+
theme(plot.title = element_text(face = "bold.italic",size = 5) )+
bbc_style()
print(p)
dev.off()
ggplotly(p)
df_dep<-fread("~/covid19/data/modificadas/covidPE_DEP_20200416_CA_clean.csv")
df_dep<-df_dep %>%
mutate(Fecha = as.Date(Fecha1))
palM1 <- c("red", "blue", "yellow", "purple", "green", "gray15", "gray34",
"blue3", "pink", "green3", "brown", "orange2", "skyblue2", "gray33",
"turquoise", "orange3", "gold", "springgreen", "dodgerblue", "purple", "gray32","black",
"blue2","red4","green3")
# pal1 <- palM[1:length(unique(df_dep$REGION))]
pal2 <- palM1[1:length(unique(df_dep$REGION))]
ggplot()+
geom_line( data=df_dep,mapping = aes(x = Fecha,y = CASOS,colour=REGION,group=REGION)) +
scale_colour_manual(values=pal2)+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=85, vjust=-0.4, hjust=0)+
theme(panel.background = element_rect(fill = "white"),
legend.position = "right",
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
# theme(axis.text.x = element_text(angle=90),
#       )+
labs(title="SARS-CoV-2 en Perú", y="Casos por región",
x="Fecha", caption="Source :varios")+
bbc_style()
target <- c("LIM")
df_otros<-filter(df_dep,! REGION %in% target)
df_lima<-filter(df_dep,REGION%in% target)
p1<-ggplot()+
geom_line( data=df_otros,mapping = aes(x = Fecha,y = CASOS,colour=REGION,group=REGION)) +
scale_colour_manual(values=pal1)+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
theme(panel.background = element_rect(fill = "white"),
legend.position = "right",
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
# theme(axis.text.x = element_text(angle=90),
#       )+
labs(title="SARS-CoV-2 en regiones", y="Casos por región",
x="Fecha", caption="Source :varios")+
bbc_style()
p2<-ggplot()+
p1<-ggplot()+
geom_line( data=df_otros,mapping = aes(x = Fecha,y = CASOS,colour=REGION,group=REGION)) +
scale_colour_manual(values=pal2)+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
theme(panel.background = element_rect(fill = "white"),
legend.position = "right",
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
# theme(axis.text.x = element_text(angle=90),
#       )+
labs(title="SARS-CoV-2 en regiones", y="Casos por región",
x="Fecha", caption="Source :varios")+
bbc_style()
ggplot()+
geom_line( data=df_otros,mapping = aes(x = Fecha,y = CASOS,colour=REGION,group=REGION)) +
scale_colour_manual(values=pal2)+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
theme(panel.background = element_rect(fill = "white"),
legend.position = "right",
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
# theme(axis.text.x = element_text(angle=90),
#       )+
labs(title="SARS-CoV-2 en regiones", y="Casos por región",
x="Fecha", caption="Source :varios")+
bbc_style()
p1<-ggplot()+
geom_line( data=df_otros,mapping = aes(x = Fecha,y = CASOS,colour=REGION,group=REGION)) +
scale_colour_manual(values=pal2)+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
theme(panel.background = element_rect(fill = "white"),
legend.position = "right",
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
# theme(axis.text.x = element_text(angle=90),
#       )+
labs(title="SARS-CoV-2 en regiones", y="Casos por región",
x="Fecha", caption="Source :varios")+
bbc_style()
p2<-ggplot()+
geom_line( data=df_lima,mapping = aes(x = Fecha,y = CASOS,colour=REGION,group=REGION)) +
scale_colour_manual(values=pal2)+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
theme(panel.background = element_rect(fill = "white"),
legend.position = "right",
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
# theme(axis.text.x = element_text(angle=90),
#       )+
labs(title="SARS-CoV-2 en Lima", y="Casos",
x="Fecha", caption="Source :varios")+
bbc_style()
##### poniendo los dos plots en grupo #######
png(filename="20200415_pruebas_vs_positivos_COVID19_lima_vs_provincias.png", width=1100, height=600)
grid.arrange(p1, p2,
ncol = 2, nrow = 2)
png(filename="20200416_pruebas_vs_positivos_COVID19_lima_vs_provincias.png", width=1100, height=600)
grid.arrange(p1, p2,
ncol = 2, nrow = 2)
dev.off()
>>>>>>> 44cdac60b9236da769c3d0cc211f772de7b7a292
library(ggplot2)
library(ggmap)
library(data.table)
library(maptools)
library(rgeos)
library(Cairo)
library(scales)
library(RColorBrewer)
library(rgdal)
library(sp)
library(plyr)
library(tmap)
library(dplyr)
setwd("~/covid19/")
## Call data
# shapefile de peru por regiones
shpfile_peru <- "data/gadm0-1-2-3/peru_1.shp"
sh_peru <- rgdal::readOGR(shpfile_peru)
# casos de covid
<<<<<<< HEAD
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200402_MD_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200403_MD_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200405_CA_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200406_MD_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200407_CA_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200408_MD_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200409_CA_clean.csv")
# caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200410_MD_clean.csv")
caso_covid <- fread("~/covid19/data/modificadas/covidPE_IND_20200411_CA_clean.csv")
=======
caso_covid <- fread("~/covid19/data/modificadas/covidPE_DEP_20200416_CA_clean.csv")
>>>>>>> 44cdac60b9236da769c3d0cc211f772de7b7a292
# tabla de poblacion por regiones
pob_region <- read.csv("~/covid19/data/Poblacion por region.csv")
## Check the neighborhood shapefile data and plot
sh_peru@data$NAME_1
# Lima and Lima Province should be the same.
# Que quede solo una Lima
sh_peru$NAME_1 <- recode(sh_peru$NAME_1, `Lima Province` = "Lima")
unique(sh_peru$NAME_1)
sh_peru$NAME_1 <- factor(sh_peru$NAME_1)
levels(sh_peru@data$NAME_1)
# Change names
str(sh_peru@data)
levels(sh_peru$NAME_1) <- c(levels(sh_peru$NAME_1),
c("Apurimac", "Huanuco",
"Junin", "San Martin"))
sh_peru_df <- sh_peru@data
sh_peru[3,6] <- "Apurimac"
sh_peru[9,6] <- "Huanuco"
sh_peru[12,6] <- "Junin"
sh_peru[23,6] <- "San Martin"
sh_peru_df <- sh_peru@data
sh_peru@data$NAME_1 <- factor(sh_peru@data$NAME_1)
levels(sh_peru@data$NAME_1)
# [1] "Amazonas"      "Ancash"        "Arequipa"      "Ayacucho"      "Cajamarca"
# [6] "Callao"        "Cusco"         "Huancavelica"  "Ica"           "La Libertad"
# [11] "Lambayeque"    "Lima"          "Loreto"        "Madre de Dios" "Moquegua"
# [16] "Pasco"         "Piura"         "Puno"          "Tacna"         "Tumbes"
# [21] "Ucayali"       "Apurimac"      "Huanuco"       "Junin"         "San Martin"
## plotting shapefiles
plot(sh_peru)
# Transformar a mayusculas
sh_peru[[6]] <- toupper(sh_peru[[6]])
str(sh_peru@data$NAME_1)
unique(sh_peru@data$NAME_1)
# [1] "AMAZONAS"      "ANCASH"        "APURIMAC"      "AREQUIPA"      "AYACUCHO"
# [6] "CAJAMARCA"     "CALLAO"        "CUSCO"         "HUANUCO"       "HUANCAVELICA"
# [11] "ICA"           "JUNIN"         "LA LIBERTAD"   "LAMBAYEQUE"    "LIMA"
# [16] "LORETO"        "MADRE DE DIOS" "MOQUEGUA"      "PASCO"         "PIURA"
# [21] "PUNO"          "SAN MARTIN"    "TACNA"         "TUMBES"        "UCAYALI"
########################################################################
# Cuando haya tiempo
# Unir lo que era Lima province (fila 15) con Lima regi?n (fila 16)
plot(sh_peru[16,])
plot(sh_peru[15,], add=T, col="red")
plot(sh_peru[16,], add=T, col="green")
#########################################################################
## Check data of cases
names(caso_covid)
<<<<<<< HEAD
colnames(caso_covid)[1] <- "CE4_ID"
colnames(caso_covid)[7] <- "NAME_1"
# Checar las variables. Que no haya tildes, espacios innecesarios o ""
unique(caso_covid$NAME_1)
# [1] "LIMA"          "AREQUIPA"      "HUANUCO"       "ICA"           "CUSCO"
# [6] "ANCASH"        "CALLAO"        "LA LIBERTAD"   "LAMBAYEQUE"    "PIURA"
# [11] "LORETO"        "MADRE DE DIOS" "SAN MARTIN"    "JUNIN"         "TUMBES"
# [16] "CAJAMARCA"     "PASCO"         "AYACUCHO"      "TACNA"         "HUANCAVELICA"
# [21] "APURIMAC"      "MOQUEGUA"      "PUNO"          "AMAZONAS"
# Cuando corre Clau, sale mal Huanuco. En laptop de Mica sale bien.
#### SI ES LAPTOP DE CLAU, PARECE QUE HAY QUE CORRER ESTAS LINEAS ########
# Eliminar NAs y tildes
# caso_covid$NAME_1[caso_covid$Caso_ID %in% c(10,11)] <- "HUANUCO"
# # no funciona no s[e por que]
caso_covid[11,7] <- "HUANUCO"
caso_covid[10,7] <- "HUANUCO"
unique(caso_covid$NAME_1)
# [1] "LIMA"          "AREQUIPA"      "HUANUCO"       "ICA"           "CUSCO"
# [6] "ANCASH"        "CALLAO"        "LA LIBERTAD"   "LAMBAYEQUE"    "PIURA"
# [11] "LORETO"        "MADRE DE DIOS" "SAN MARTIN"    "JUNIN"         "TUMBES"
# [16] "CAJAMARCA"     "PASCO"         "AYACUCHO"      "TACNA"         "HUANCAVELICA"
# [21] "APURIMAC"      "MOQUEGUA"      "PUNO"          "AMAZONAS"      "UCAYALI"
casos_region <- data.frame(table(caso_covid$NAME_1))
colnames(casos_region)[1] <- "REGION"
colnames(casos_region)[2] <- "NUMERO_CASOS"
=======
colnames(caso_covid)[2] <- "NAME_1"
# Checar las variables. Que no haya tildes, espacios innecesarios o ""
unique(caso_covid$NAME_1)
# [1] "LIM" "ARE" "HUC" "ICA" "CUS" "PIU" "LAM" "CAL" "LAL" "ANC" "LOR"
# [12] "SAM" "MDD" "JUN" "TUM" "CAJ" "PAS" "TAC" "AYA" "HUA" "APU" "MOQ"
# [23] "PUN" "AMA" "UCA"
mt <- tapply(caso_covid$CASOS, list(caso_covid$NAME_1), sum)
casos_region <- as.data.frame(mt)
casos_region <- cbind(NAME_LABEL = rownames(casos_region), casos_region)
colnames(casos_region)[2] <- "NUMERO_CASOS"
unique(casos_region$NAME_LABEL)
# [1] AMA ANC APU ARE AYA CAJ CAL CUS HUA HUC ICA JUN LAL LAM LIM
# [16] LOR MDD MOQ PAS PIU PUN SAM TAC TUM UCA
casos_region$REGION <- revalue(casos_region$NAME_LABEL,
c("ANC"="ANCASH",
"ARE"="AREQUIPA",
"AYA"="AYACUCHO",
"CAJ"="CAJAMARCA",
"CAL"="CALLAO",
"CUS"="CUSCO",
"HUC"="HUANUCO",
"ICA" ="ICA",
"JUN"="JUNIN",
"LAL"= "LA LIBERTAD",
"LAM"="LAMBAYEQUE",
"LIM"="LIMA",
"LOR"="LORETO",
"MDD"="MADRE DE DIOS",
"PAS"="PASCO",
"PIU"="PIURA",
"SAM"="SAN MARTIN",
"TAC"="TACNA",
"TUM"="TUMBES",
"AMA"="AMAZONAS",
"MOQ"="MOQUEGUA",
"APU"="APURIMAC",
"HUA"="HUANCAVELICA",
"PUN"="PUNO",
"UCA"="UCAYALI"))
>>>>>>> 44cdac60b9236da769c3d0cc211f772de7b7a292
## Checar csv de poblaciones regionales
names(pob_region) # "REGION"    "POBLACION"
pob_region[[1]] <- toupper(pob_region[[1]])
unique(pob_region$REGION) # todo ok
# [1] "AMAZONAS"      "ANCASH"        "APURIMAC"      "AREQUIPA"      "AYACUCHO"
# [6] "CAJAMARCA"     "CALLAO"        "CUSCO"         "HUANCAVELICA"  "HUANUCO"
# [11] "ICA"           "JUNIN"         "LA LIBERTAD"   "LAMBAYEQUE"    "LIMA"
# [16] "LORETO"        "MADRE DE DIOS" "MOQUEGUA"      "PASCO"         "PIURA"
# [21] "PUNO"          "SAN MARTIN"    "TACNA"         "TUMBES"        "UCAYALI"
## Merge cases with populations
region_values <- merge(casos_region, pob_region, by="REGION",
all.x=T, all.y=T)
## Calcula incidencias
region_values$NUMERO_CASOS <- as.numeric(region_values$NUMERO_CASOS)
region_values$POBLACION <- as.numeric(as.character(region_values$POBLACION))
region_values$incidencia <- region_values$NUMERO_CASOS/region_values$POBLACION
options(digits = 2)
region_values$incidencerate_100 <-(region_values$incidencia*100000)
## recode the names of the region_values data frame
setnames(region_values, old = "REGION",new = "NAME_1")
levels(region_values$NAME_1)
<<<<<<< HEAD
# [1] "ANCASH"        "APURIMAC"      "AREQUIPA"      "AYACUCHO"
# [5] "CAJAMARCA"     "CALLAO"        "CUSCO"         "HUANCAVELICA"
# [9] "HUANUCO"       "ICA"           "JUNIN"         "LA LIBERTAD"
# [13] "LAMBAYEQUE"    "LIMA"          "LORETO"        "MADRE DE DIOS"
# [17] "MOQUEGUA"      "PASCO"         "PIURA"         "PUNO"
# [21] "SAN MARTIN"    "TACNA"         "TUMBES"        "AMAZONAS"
# [25] "UCAYALI"
## Create labels that does not occupy
=======
# [1] "AMAZONAS"      "ANCASH"        "APURIMAC"      "AREQUIPA"      "AYACUCHO"
# [6] "CAJAMARCA"     "CALLAO"        "CUSCO"         "HUANCAVELICA"  "HUANUCO"
# [11] "ICA"           "JUNIN"         "LA LIBERTAD"   "LAMBAYEQUE"    "LIMA"
# [16] "LORETO"        "MADRE DE DIOS" "MOQUEGUA"      "PASCO"         "PIURA"
# [21] "PUNO"          "SAN MARTIN"    "TACNA"         "TUMBES"        "UCAYALI"
## Create labels that does not occupy
region_values <- region_values[,-2]
>>>>>>> 44cdac60b9236da769c3d0cc211f772de7b7a292
region_values$NAME_LABEL <- region_values$NAME_1
str(region_values$NAME_LABEL)
region_values$NAME_LABEL <- revalue(region_values$NAME_LABEL,
c("ANCASH"="ANC",
"AREQUIPA"="AQP",
"AYACUCHO" ="AYA",
"CAJAMARCA"="CAJ",
"CALLAO"="CAL",
"CUSCO" ="CUS",
"HUANUCO" ="HCO",
"ICA" ="ICA",
"JUNIN" ="JUN",
"LA LIBERTAD" ="LAL",
"LAMBAYEQUE" ="LAM",
"LIMA" ="LIM",
"LORETO"="LOR",
"MADRE DE DIOS"="MDD",
"PASCO" ="PAS",
"PIURA"="PIU",
"SAN MARTIN"="SAM",
"TACNA" ="TAC",
"TUMBES" ="TUM",
"AMAZONAS" ="AMA",
"MOQUEGUA"="MOQ",
"APURIMAC"="APU",
"HUANCAVELICA"="HUV",
"PUNO"="PUN",
"UCAYALI"="UCA"))
## Merge data with shapefile
tmp1 <- sh_peru
tmp1_map <- tmp1
tmp1_map@data <- join(sh_peru@data,region_values, by="NAME_1") # shp with data
tmp1_map_df <- tmp1_map@data
tmp1_map@data$NUMERO_CASOS[is.na(tmp1_map@data$NUMERO_CASOS)]<-0
tmp1_map@data$incidencia[is.na(tmp1_map@data$incidencia)]<-0
tmp1_map@data$incidencerate_100[is.na(tmp1_map@data$incidencerate_100)]<-0
tmp1_map_df <- tmp1_map@data
tmp1_map@data$brks <- cut(tmp1_map@data$incidencerate_100,
<<<<<<< HEAD
breaks=c(-0.1, 0.0, 1, 2, 4, 8, 12, 16, 100),
labels=c("0", "< 1", "1 a 2",
"2 a 4", "4 a 8", "8 a 12",
#"8 a 10",
"12 a 16", "> 16"))
names(tmp1_map@data) # check variables
tmp1_map_df <- tmp1_map@data
# Create the map qtm
col <- c("white", "ivory2", "lightcyan1", "lightblue2",
=======
breaks=c(0.0, 1, 2, 5, 10, 20, 40, 100),
labels=c("< 1", "1 a 2",
"2 a 5", "5 a 10", "10 a 20",
#"8 a 10",
"20 a 40", "> 40"))
names(tmp1_map@data) # check variables
tmp1_map_df <- tmp1_map@data
# Create the map qtm
col <- c("ivory2", "lightcyan1", "lightblue2",
>>>>>>> 44cdac60b9236da769c3d0cc211f772de7b7a292
#"lightskyblue",
"royalblue", "blue2", "navyblue", "black")
# col <- c("ivory2", "lightcyan1", "lightblue2", "lightskyblue",
#           "royalblue", "blue2", "navyblue", "black")
# try snow2 too
# interactive view
#tmap_mode("view")
# crear mapa
qtm <- qtm(tmp1_map, #fill = "incidencerate_100",
fill = "brks",
fill.palette = col,
fill.title="Incidencia por \n100,000 Hab") +
# tm_text("NAME_3", size="0.008", scale=1, root=4,
#         size.lowerbound = .1, bg.color="white", bg.alpha = .15,
#         legend.size.show = FALSE) +
tm_text("NAME_LABEL",size = 0.5)+
tm_layout(paste("Incidencia de \nSARS-CoV2 \nen Peru"), title.size = .92,
legend.title.size = 0.8,
legend.text.size = .6, legend.bg.color = NA,
legend.position = c("left","bottom"),
#outer.margins =c(0.05, 0.05, 0.05, 0.05)
#inner.margins =c(0.05, 0.05, 0.05, 0.05)
title.position = c(.05,.905)) #+ vs5
#tm_view(set.view = c(lon = 15, lat = 48, zoom = 10))
# tm_view(set.view = c(zoom = 10))
print(qtm)
<<<<<<< HEAD
tmap_mode("view")
# crear mapa
qtm <- qtm(tmp1_map, #fill = "incidencerate_100",
fill = "brks",
fill.palette = col,
fill.title="Incidencia por \n100,000 Hab") +
# tm_text("NAME_3", size="0.008", scale=1, root=4,
#         size.lowerbound = .1, bg.color="white", bg.alpha = .15,
#         legend.size.show = FALSE) +
tm_text("NAME_LABEL",size = 0.5)+
tm_layout(paste("Incidencia de \nSARS-CoV2 \nen Peru"), title.size = .92,
legend.title.size = 0.8,
legend.text.size = .6, legend.bg.color = NA,
legend.position = c("left","bottom"),
#outer.margins =c(0.05, 0.05, 0.05, 0.05)
#inner.margins =c(0.05, 0.05, 0.05, 0.05)
title.position = c(.05,.905)) #+ vs5
#tm_view(set.view = c(lon = 15, lat = 48, zoom = 10))
# tm_view(set.view = c(zoom = 10))
print(qtm)
=======
# RECUERDA CAMBIAR EL NOMBRE DEL ARCHIVO!
tmap_save(qtm,
paste("outputs_covid19/20200416_Dep_COVID19_Incidencerate",
".png", sep=""),
width=2300, height=1380)
png(filename="20200416_pruebas_vs_positivos_COVID19.png", width=1100, height=600)
p<-ggplot() +
geom_line(data = acumulado1, aes(Fecha, value, colour=variable,group=variable),alpha =1.6) +
scale_colour_manual(values=c("red", "blue"))+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
# scale_x_date() +
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
# theme_minimal()+
theme(panel.background = element_rect(fill = "white"),
legend.position = c(0.35,0.95),
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
labs(title="SARS-CoV-2 en Perú", y="Pruebas positivas y pruebas realizadas",
x="Fecha", caption="Source :varios")+
theme(plot.title = element_text(face = "bold.italic",size = 5) )+
bbc_style()
print(p)
dev.off()
png(filename="20200416_pruebas_vs_positivos_COVID19.png", width=1100, height=600)
ggplot() +
geom_line(data = acumulado1, aes(Fecha, value, colour=variable,group=variable),alpha =1.6) +
scale_colour_manual(values=c("red", "blue"))+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
# scale_x_date() +
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
# theme_minimal()+
theme(panel.background = element_rect(fill = "white"),
legend.position = c(0.35,0.95),
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
labs(title="SARS-CoV-2 en Perú", y="Pruebas positivas y pruebas realizadas",
x="Fecha", caption="Source :varios")+
theme(plot.title = element_text(face = "bold.italic",size = 5) )+
bbc_style()
# print(p)
dev.off()
ggplot() +
geom_line(data = acumulado1, aes(Fecha, value, colour=variable,group=variable),alpha =1.6) +
scale_colour_manual(values=c("red", "blue"))+
scale_x_date(labels = date_format("%d-%b"),breaks = as.Date(c("2020-03-06", "2020-03-11", "2020-03-12", "2020-03-15", "2020-03-26","2020-03-31","2020-04-02","2020-04-07")),
minor_breaks = NULL)+
# scale_x_date() +
geom_vline(data=d, mapping=aes(xintercept=Fecha), color="gray") +
geom_text(data=d, mapping=aes(x=Fecha, y =0,label=event), size=4, angle=90, vjust=-0.4, hjust=0)+
# theme_minimal()+
theme(panel.background = element_rect(fill = "white"),
legend.position = c(0.35,0.95),
legend.justification = c("right","top"),
axis.text.x = element_text(vjust =0.60,angle=60,face = "bold.italic", size = 10))+
labs(title="SARS-CoV-2 en Perú", y="Pruebas positivas y pruebas realizadas",
x="Fecha", caption="Source :varios")+
theme(plot.title = element_text(face = "bold.italic",size = 5) )+
bbc_style()
>>>>>>> 44cdac60b9236da769c3d0cc211f772de7b7a292
