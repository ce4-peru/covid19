setwd("~/R code/covid19/data/modificadas")
setwd("~/covid19/data/modificadas")
df0 <- read.csv("covidPE_IND_20200331_MD_clean.csv")
View(df0)
df0 <- df0[2:17]
View(df0)
colnames(df0) <- c("ID", "Date", "Day", "Month", "Year", "Region", "Provence", "Disctrict",
"Direction", "Age1", "Age", "Sex", "Hospitilized", "AISLADODOMICILS1N0",
"Contact","Imported") #KEY: Sex:M=1,F=0|Hospitilized:Yes=1,No=0|Imported:Yes=1,No=0)
#df0$Date <- as.Date(df0$Date, "%m/%d/%Y") #Fix date format
df0$Date <- as.Date(df0$Date)
View(df0)
Regions <- levels(droplevels(unique(df0$Region))) #Regions
Dates <- as.data.frame(seq(as.Date(min(df0$Date)), as.Date(max(df0$Date)), "days")); colnames(Dates) <- c("Date") #Dates
View(Dates)
df <- data.frame(Dates) #Create table to build on
View(df)
#Find total number of cases per day per region (Line list --> incidence table)
for (i in 1:length(Regions)){
R1 = Regions[i]
df.sub <- subset(df0, df0$Region == R1) #Subset to region in loop
df.sub <- as.data.frame(table(df.sub$Date)); df.sub$Var1 <- as.Date(df.sub$Var1) #Generate counts table
Dates$Match <- df.sub$Freq[match(Dates$Date, df.sub$Var1)]; Dates[is.na(Dates)] <- 0 #Match counts with Date ref
df <- cbind(df, Dates$Match); colnames(df)[i+1] <- paste0(R1) #bind onto main df
}
df$Peru = rowSums(df[,c(-1)]) #Find totals for Peru
View(df)
df <- subset(df, select=-c(TACNA, AYACUCHO)) #Remove CAJAMARCA bc only have one case, messing up loops
View(df)
#Set up reference regions and blank dfs
Regions <- colnames(df)
Regions <- Regions[-1]
df.lm <- NULL #INSTANTANEOUS
df.lm2 <- NULL #OVERALL
for (i in 1:length(Regions)){
R1 = Regions[i]
df.sub <- data.frame(df[, 1], df[,(i+1)]); colnames(df.sub) <- c("Date", paste0(R1)) #Subset by region
df.sub <- df.sub[paste0(min(which(df.sub[2] != 0))):length(df.sub$Date),] #Find first non 0
######################INSTANTANEOUS RATES################################
for (j in 2:(length(df.sub$Date) - 1)) {
#Create "instantaneous" data frame
D1 <- df.sub$Date[j]  #Loop through each day (except first and last)
df.sub2 <- subset(df.sub, df.sub$Date == D1 -1 | df.sub$Date == D1 |  df.sub$Date == D1 + 1) #get "instantaneous" rate based on 3 days
df.sub2[2] <- log(df.sub2[2]) #take ln of # of cases so can use linear model to get exp rates later
df.sub2$Day <- seq(1:length(df.sub2$Date)) #Add in day number to use as independent variable in linear model
colnames(df.sub2) <- c("Date", "LogCases", "Day")
df.sub2$LogCases <- ifelse(df.sub2$LogCases < 0, 0, df.sub2$LogCases) ####NOT SURE IF THIS IS BEST APPROACH (ln(0) = -INF --> changed to 0?)
#Fit exponential model to 3 point instantaneous rate
lm <- lm(LogCases ~ Day, data=df.sub2) #linear model of three days
row1 <-  c(paste0(R1), paste0(D1), as.numeric(lm$coefficients[1]), as.numeric(lm$coefficients[2])) #Pull out coefficients
df.lm <- rbind(df.lm, row1)
}
######################Overall rates################################
df.sub$Day <- seq(1:length(df.sub$Date)) #Add in day number to use as independent variable in linear model
colnames(df.sub) <- c("Date", "Cases", "Day")
df.sub$LogCases <- log(df.sub$Cases) #take ln of # of cases so can use linear model to get exp rates later
df.sub$LogCases <- ifelse(df.sub$LogCases < 0, 0, df.sub$LogCases) ####NOT SURE IF THIS IS BEST APPROACH (ln(0) = -INF --> changed to 0?)
lm1 <- lm(LogCases ~ Day, data=df.sub) #fit linear model for all days
row2 <-  c(paste0(R1), as.numeric(lm1$coefficients[1]), as.numeric(lm1$coefficients[2])) #Pull out coefficients
df.lm2 <- rbind(df.lm2, row2)
}
View(lm1)
View(lm)
View(df0)
View(df.lm)
View(df.lm2)
View(df.sub2)
df.lm <- as.data.frame(df.lm)
View(df.lm)
colnames(df.lm) <- c("Region", "Date", "Intercept", "InstantaneousRate")
View(df.lm)
df.lm$Date <- as.Date(df.lm$Date)
df.lm$InstantaneousRate <- as.character(df.lm$InstantaneousRate); df.lm$InstantaneousRate <- as.numeric(df.lm$InstantaneousRate)
#format as df
df.lm2 <- as.data.frame(df.lm2)
colnames(df.lm2) <- c("Region", "Intercept", "OverallRate")
df.lm2$OverallRate <- as.character(df.lm2$OverallRate); df.lm2$OverallRate <- as.numeric(df.lm2$OverallRate)
View(df.lm2)
###############################################################################################################
#Figures
###############################################################################################################
#set color pallettes
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
"red3", "orange", "gold", "springgreen4", "dodgerblue3", "mediumpurple", "gray")
pal1 <- palM[1:length(unique(df0$Region))]
pal1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(Date, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(Date, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
library(ggplot2)
library(gridExtra)
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(Date, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
fig1
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1)
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))
library("ggplot2")
tmp <- data.frame(x=rep(seq(as.Date(0, origin="1970-01-01"),
length=36, by="1 month"), 2),
y=rnorm(72),
category=gl(2,36))
tmp
p <- ggplot(tmp, aes(x, y, colour=category)) +
layer(geom="line") +
geom_vline(aes(xintercept=as.numeric(x[c(13, 24)])),
linetype=4, colour="black")
p <- ggplot(tmp, aes(x, y, colour=category)) +
layer(geom="line") +
geom_vline(aes(xintercept=as.numeric(x[c(13, 24)])),
linetype=4, colour="black")
print(p)
rlang::last_error()
ggplot(tmp, aes(x, y, colour=category))
layer(geom="line")
geom_vline(aes(xintercept=as.numeric(x[c(13, 24)]))
geom_vline(aes(xintercept=as.numeric(x[c(13, 24)])),
linetype=4, colour="black")
gg + geom_vline(xintercept=as.numeric(mydata$datefield[120]), linetype=4)
gg <- ggplot(data=mydata,aes(y=somevalues,x=datefield,color=category)) +
layer(geom="line")
View(df0)
View(df0)
library(data.table)
acumulado<-fread("~/covid19/data/modificadas/covidPE_PORdia_20200403_MD_clean.csv")
View(acumulado)
#set color pallettes
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
"red3", "orange", "gold", "springgreen4", "dodgerblue3", "mediumpurple", "gray")
pal1 <- palM[1:length(unique(df0$Region))]
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
"red3", "orange", "gold", "springgreen4", "dodgerblue3", "mediumpurple", "gray")
setwd('~/covid19/outputs_covid19/')
####casos_acumulado por semana#####
### weekly incidense #####
acumulado_dep<-fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv")
#acumulado_dep <- mutate_if(acumulado_dep, is.character, toupper)
#acumulado_dep<-acumulado_dep %>%
#  mutate(Fecha = as.Date(as.character(Fecha), format = "%d/%m/%y"))
#str(acumulado_dep, strict.width = "cut", width = 76)
i.7.group <- incidence(acumulado_dep$FECHA, interval = 7,
groups = acumulado_dep$REGION)
library(JLutils)
library(magrittr)
library(ggthemr)
library(ggplot2)
library('incidence')
library('outbreaks')
setwd('~/covid19/outputs_covid19/')
####casos_acumulado por semana#####
### weekly incidense #####
acumulado_dep<-fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv")
#acumulado_dep <- mutate_if(acumulado_dep, is.character, toupper)
#acumulado_dep<-acumulado_dep %>%
#  mutate(Fecha = as.Date(as.character(Fecha), format = "%d/%m/%y"))
#str(acumulado_dep, strict.width = "cut", width = 76)
i.7.group <- incidence(acumulado_dep$FECHA, interval = 7,
groups = acumulado_dep$REGION)
# plot
my_theme <- theme_bw(base_size = 12) +
theme(panel.grid.minor = element_blank()) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0.5, color = "black"))
# save plot
png(filename="20200404_weekly_incid_COVID19.png")
plot(i.7.group, border = "white", ylab="N?mero de casos por semana") +
my_theme +
# theme(legend.position = "topleft")
theme(legend.position = c(-1.0, -1.0))
dev.off()
i.7.group <- incidence(acumulado_dep$FECHA, interval = 1,
groups = acumulado_dep$REGION)
# plot
my_theme <- theme_bw(base_size = 12) +
theme(panel.grid.minor = element_blank()) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0.5, color = "black"))
png(filename="20200404_daily_incid_COVID19.png")
plot(i.7.group, border = "white", ylab="N?mero de casos por d?a") +
my_theme +
# theme(legend.position = "topleft")
theme(legend.position = c(-1.0, -1.0))
dev.off()
acumulado<-fread("~/covid19/data/modificadas/covidPE_PORdia_20200404_MD_clean.csv")
#set color pallettes
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
"red3", "orange", "gold", "springgreen4", "dodgerblue3", "mediumpurple", "gray")
View(acumulado)
View(df0)
pal1 <- palM[1:length(unique(acumulado$TOTAL_POSITIVOS))]
df0<-fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv)
#set color pallettes
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
df0<-fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv)
df0<-fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv")
df0 <-fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv")
#set color pallettes
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
"red3", "orange", "gold", "springgreen4", "dodgerblue3", "mediumpurple", "gray")
pal1 <- palM[1:length(unique(df0$REGION))]
acumulado<-fread("~/covid19/data/modificadas/covidPE_PORdia_20200404_MD_clean.csv")
fig1 <- ggplot() +
theme_classic()+
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(Date, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
fig1
df0 <-fread("~/covid19/data/modificadas/covidPE_IND_20200404_MD_clean.csv")
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
"red3", "orange", "gold", "springgreen4", "dodgerblue3", "mediumpurple", "gray")
pal1 <- palM[1:length(unique(df0$REGION))]
#Figure 1: Peru epicurve
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(Date, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(Date, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
View(df0)
View(Dates)
View(df0)
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(FECHA, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$Date)-1, max(df0$Date)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(FECHA, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$FECHA)-1, max(df0$FECHA)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(FECHA, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(df0$FECHA)-1, max(df0$FECHA)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(FECHA, fill= Region), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(df0$FECHA)-1, max(df0$FECHA)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado, geom="line")
fig1
View(df0)
palM <- c("maroon", "darkorange3", "goldenrod3", "darkgreen", "navy", "plum4", "black",
"lightcoral", "peachpuff2", "khaki1", "olivedrab3", "steelblue1", "thistle", "snow2",
"red3", "orange", "gold", "springgreen4", "dodgerblue3", "mediumpurple", "gray")
pal1 <- palM[1:length(unique(df0$REGION))]
#Figure 1: Peru epicurve
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(FECHA, fill= REGION), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(df0$FECHA)-1, max(df0$FECHA)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado, geom="line")
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(FECHA, fill= REGION), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(df0$FECHA)-1, max(df0$FECHA)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = df0, aes(FECHA, fill= REGION), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(df0$FECHA)-1, max(df0$FECHA)+1, 1))+
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
stat_density(data = acumulado$TOTAL_PRUEBAS, geom="line")
fig1
d=data.frame(date=as.Date(c("1971-09-01", "1991-12-01", "1994-12-01", "2000-01-01", "2002-08-01", "2005-08-01")), event=c("birth", "entered college", "BS", "entered grad school", "MS", "PhD"))
View(d)
nmonths = 24
x = seq(as.Date("2015/1/1"), by = "month", length.out = nmonths)
prescription1 <- data.frame(
x,
Percent.Change = 25 + runif(nmonths,1,100)
)
prescription2 <- data.frame(
x,
Percent.Change = 75 + runif(nmonths,1,50)
)
View(prescription1)
View(prescription2)
cols = c("dates", "Difference")
colnames(prescription1) = cols
colnames(prescription2) = cols
View(prescription2)
acumulado<-fread("~/covid19/data/modificadas/covidPE_PORdia_20200404_MD_clean.csv")
View(acumulado)
d<-fread("~/Downloads/covidPE_casos - Sheet15.csv")
View(d)
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes(x = acumulado$FECHA, y =acumulado$TOTAL_PRUEBAS ), color = "blue")
geom_vline(data=d, mapping=aes(xintercept=date), color="blue") +
geom_text(data=d, mapping=aes(x=d$FECHA, y=0, label=d$EVENTO), size=4, angle=90, vjust=-0.4, hjust=0) +
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes(x = acumulado$FECHA, y =acumulado$TOTAL_PRUEBAS ), color = "blue")
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes(x = acumulado$FECHA, y =acumulado$TOTAL_PRUEBAS ), color = "blue")+
geom_vline(data=d, mapping=aes(xintercept=date), color="blue") +
geom_text(data=d, mapping=aes(x=d$FECHA, y=0, label=d$EVENTO), size=4, angle=90, vjust=-0.4, hjust=0) +
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))+
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes(x = acumulado$FECHA, y =acumulado$TOTAL_PRUEBAS ), color = "blue")+
geom_vline(data=d, mapping=aes(xintercept=date), color="blue") +
geom_text(data=d, mapping=aes(x=d$FECHA, y=0, label=d$EVENTO), size=4, angle=90, vjust=-0.4, hjust=0) +
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="black", binwidth = 1)+
scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes(x = acumulado$FECHA, y =acumulado$TOTAL_PRUEBAS ), color = "blue")+
geom_vline(data=d, mapping=aes(xintercept=FECHA), color="blue") +
geom_text(data=d, mapping=aes(x=d$FECHA, y=0, label=d$EVENTO), size=4, angle=90, vjust=-0.4, hjust=0) +
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="red", binwidth = 1)+
# scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes( y =acumulado$TOTAL_PRUEBAS ), color = "blue")+
geom_vline(data=d, mapping=aes(xintercept=FECHA), color="blue") +
geom_text(data=d, mapping=aes(x=d$FECHA, y=0, label=d$EVENTO), size=4, angle=90, vjust=-0.4, hjust=0) +
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="red", binwidth = 1)+
# scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes( x=acumulado$FECHA,y =acumulado$TOTAL_PRUEBAS ), color = "blue")+
geom_vline(data=d, mapping=aes(xintercept=FECHA), color="blue") +
geom_text(data=d, mapping=aes(x=d$FECHA, y=0, label=d$EVENTO), size=4, angle=90, vjust=-0.4, hjust=0) +
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="red", binwidth = 1)+
# scale_fill_manual(values = pal1)+
# scale_x_date(breaks=seq(min(acumulado$FECHA)-1, max(acumulado$FECHA)+1, 1))+
geom_line(data = , aes( x=acumulado$FECHA,y =acumulado$TOTAL_PRUEBAS ), color = "blue")
fig1
fig1 <- ggplot() +
theme_classic()+
geom_histogram(data = acumulado, aes(x= acumulado$FECHA,y=acumulado$TOTAL_POSITIVOS), color="red", binwidth = 1)+
geom_vline(data=d, mapping=aes(xintercept=FECHA), color="blue") +
geom_text(data=d, mapping=aes(x=d$FECHA, y=0, label=d$EVENTO), size=4, angle=90, vjust=-0.4, hjust=0) +
labs(title= "COVID-19 Peru Cases")+
xlab("Date of lab confirmation") + ylab("Total new cases")+
theme(axis.text.x = element_text(angle=90))
fig1
d=data.frame(date=as.Date(c("1971-09-01", "1991-12-01", "1994-12-01", "2000-01-01", "2002-08-01", "2005-08-01")), event=c("birth", "entered college", "BS", "entered grad school", "MS", "PhD"))
ggplot() +
scale_x_date(limits=as.Date(c("1970-1-1", "2010-12-31"))) +
scale_y_continuous(name="", breaks=NA, limits=c(0,1)) +
geom_vline(data=d, mapping=aes(xintercept=date), color="blue") +
geom_text(data=d, mapping=aes(x=date, y=0, label=event), size=4, angle=90, vjust=-0.4, hjust=0) +
opts(title="geom_vline", plot.title=theme_text(size=40, vjust=1.5)
ggplot() +
scale_x_date(limits=as.Date(c("1970-1-1", "2010-12-31"))) +
scale_y_continuous(name="", breaks=NA, limits=c(0,1)) +
geom_vline(data=d, mapping=aes(xintercept=date), color="blue") +
geom_text(data=d, mapping=aes(x=date, y=0, label=event), size=4, angle=90, vjust=-0.4, hjust=0) +
opts(title="geom_vline", plot.title=theme_text(size=40, vjust=1.5)
